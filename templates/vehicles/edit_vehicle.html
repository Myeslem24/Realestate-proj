{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø±Ø©</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; }
    .form-section {
      background: white;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      max-width: 700px;
      margin: auto;
    }
  </style>
</head>
<body>

<div class="container my-5">
  <a href="{% url 'dashboard' %}" class="btn btn-secondary mb-4">ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>

  <div class="form-section">
    <h3 class="text-center mb-4">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø±Ø©</h3>

    <form method="post">
      {% csrf_token %}

      {{ form.non_field_errors }}

      <div class="mb-3">
        <label for="id_brand" class="form-label">Ø§Ù„Ø´Ø±ÙƒØ©</label>
        {{ form.brand }}
      </div>

      <div class="mb-3">
        <label for="id_model" class="form-label">Ø§Ù„Ø·Ø±Ø§Ø²</label>
        {{ form.model }}
      </div>

      <div class="mb-3">
        <label for="id_year" class="form-label">Ø³Ù†Ø© Ø§Ù„ØµÙ†Ø¹</label>
        {{ form.year }}
      </div>

      <div class="mb-3">
        <label for="id_fuel_type" class="form-label">Ù†ÙˆØ¹ Ø§Ù„ÙˆÙ‚ÙˆØ¯</label>
        {{ form.fuel_type }}
      </div>

      <div class="mb-3">
        <label for="id_condition" class="form-label">Ø§Ù„Ø­Ø§Ù„Ø©</label>
        {{ form.condition }}
      </div>

      <div class="mb-3">
        <label for="id_price" class="form-label">Ø§Ù„Ø³Ø¹Ø±</label>
        {{ form.price }}
      </div>

      <div class="mb-3">
        <label for="id_description" class="form-label">Ø§Ù„ÙˆØµÙ</label>
        {{ form.description }}
      </div>

      <div class="mb-3">
        <label for="id_image" class="form-label">ğŸ“¸ ØµÙˆØ±Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø©</label>
        {{ form.image }}
      </div>

      <div class="mb-3">
        <label for="id_video" class="form-label">ğŸ¥ ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø³ÙŠØ§Ø±Ø©</label>
        {{ form.video }}

      </div>
      <div class="form-check mb-3">
        {{ form.is_sold }}
        <label class="form-check-label" for="id_is_sold">ØªÙ… Ø§Ù„Ø¨ÙŠØ¹</label>
      </div>

      <button type="submit" class="btn btn-warning w-100">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
    </form>
  </div>
</div>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- AJAX Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ø±Ø§Ø²Ø§Øª -->
<script>
  $(document).ready(function() {
    $('#id_brand').on('change', function() {
      const brandId = $(this).val();
      if (brandId) {
        $.ajax({
          url: "{% url 'get_car_models' %}",
          data: { brand_id: brandId },
          dataType: 'json',
          success: function(data) {
            let options = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø·Ø±Ø§Ø²</option>';
            data.forEach(function(item) {
              options += `<option value="${item.id}">${item.name}</option>`;
            });
            $('#id_model').html(options);
          }
        });
      } else {
        $('#id_model').html('<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø·Ø±Ø§Ø²</option>');
      }
    });

    // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø·Ø±Ø§Ø²Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
    $('#id_brand').trigger('change');
  });
</script>

</body>
</html>
